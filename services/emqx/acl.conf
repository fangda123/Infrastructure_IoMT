# Allow admin user to access all topics
{allow, {user, "admin"}, subscribe, ["$SYS/#"]}.
{allow, {user, "admin"}, publish, ["$SYS/#"]}.

# Allow localhost to access system topics
{allow, {ipaddr, "127.0.0.1"}, pubsub, ["$SYS/#"]}.

# Device topics
{allow, all, subscribe, ["devices/+/data"]}.
{allow, all, publish, ["devices/+/data"]}.
{allow, all, subscribe, ["devices/+/status"]}.
{allow, all, publish, ["devices/+/status"]}.
{allow, all, subscribe, ["devices/+/config"]}.
{allow, all, publish, ["devices/+/config"]}.

# Command topics
{allow, {user, "admin"}, publish, ["devices/+/command/#"]}.
{allow, all, subscribe, ["devices/+/command/#"]}.

# Deny all other access
{deny, all, subscribe, ["$SYS/#"]}.
{deny, all, publish, ["$SYS/#"]}.
{deny, all, subscribe, ["#"]}.
{deny, all, publish, ["#"]}. 